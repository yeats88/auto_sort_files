# auto_sort_out 自动分类整理归档工具

初衷是为了让部分部门不甚了解文件分类的人员快速分类归档电脑文件，适用于文职人员对于大量文件分类归档整理。虽然可能还是没什么用。

~~派大星：我们不是原始人，我们拥有高科技！~~

所有功能初步测试可用，但不保证可靠性，源代码中还有大量的奇葩注释和蹩脚翻译提醒未解决。

似乎又是重复造车轮，已经有类似的成熟的工程项目了......~~但是我还是完成了。~~


## 目前发现的问题

+ 文件名中不要含有空格，不然还原的时候会因为目录分隔问题而无法查找，虽然可以通过修改日志格式确定不同的记录风格处理，但是名称不要含有空格不是常识么……暂时未作修改。

## 注意！！！

+ 无论那种类型的分类，都是破坏原有的目录结构，请慎用。后悔药功能已经上线（recover函数，但是需要sort_out_log文件保留不被破坏）！但即便是有后悔药功能，也不见得很有用，bug较多，所以还是请慎重分类——最好用作数据归档，大概N年不会动的那种。

+ 目录下生成的sort_out_log文件不要删除或者修改，否则后悔药功能无法启用。

+ 虽然加入了对一些含有特殊文件以及特殊目录的地方禁止动手脚的保护机制，但是难免会失效，请慎用此功能。

## 功能

自动整理文件目录，可以根据目录下文件类型归档也可以根据文件的创建、最后访问、最后修改的时间进行分类，可以以年作为目录分类（easy模式），可以年/月做多层目录分类（normal模式），还有丧心病狂的年月日模式分类归档（all模式）。或者根据特殊的关键字进行分类，但是关键字太过于灵活，bug可能最多，不建议用到

## 所需的Python模块（Python3）

+ os 大部分文件操作使用

+ re 正则表达检索等用途

+ shutil 文件移动使用

+ time 获取文件时间信息后格式化使用

+ json 读取配置文件使用

+ sys 检测配置文件地址时使用

~~+ sort_out，必须的～~~

## 使用

建立一个demo,或者一个main的py脚本，然后：


    import sort_out as SOF 
    f=SOF.Sort_Out("/home/xxx/Documents") #为了安全初始化必须指定目录
    #f.path=("/home/xxx/Documents")#如果中途想使用别的路径可以重新赋值给path
    f.sort_out_by_mtime(“mtime”,"normal") #将/home/xxx/Documents中的文件按照最后修改时间的年/月目录分类
    #f.sort_out_by_filetype() #根据文件类型将/home/xxx/Picturesde文件分类，暂时为分类图片类
    #PS：如果已经分类了的目录将无法再一次进行分类
    #f.recover()#后悔药功能，只要目录下的sort_out_log文件不要删除更改就可以还原
    #f.close()#清空f内产生的变量——除了config.json引入的私有变量
    
## 所需文件内容

程序目录下需要：

+ main.py 用户自己编写用于交互的主模块

+ sort_out.py 所需模块

+ config.json 和执行脚本处于一个目录中，用于提前设定好一些文件类别、安全设定等

main.py中导入sort_out.py模块，然后根据config.json的设置确定文件类型和“雷区”

## class的内容

### 变量

+ path：要处理的目录路径

+ info：字典文件，包含所有文件的名称、大小、修改时间、最后访问时间、创建时间以及。。。文件类型，具体可看源代码中的变量名称。其中Size本用作文件大小使用，但是暂未发现有什么用途，所以get方法中注释掉了，但是字典中的空数组依然保留——是在不喜欢这两处可以完全删掉。

+ total：文件的总数——其实就是len(self.info["File"])，为了代码可读性和方便……

+ __forbidden_file：如果目录下存在这些后缀名的文件将禁止分类，详细内容在config.json中，用户可以自己添加

+ __forbidden_dir：如果目录中含有其中的关键字则禁止分类,详细内容在config.json中，用户可以自己添加

+ __file_type：按照文件类型分类的时候所需的类别，详细内容在config.json中，用户可以自己添加修改

### 函数调用

+ __get(file_name)：获取文件的信息，存储到info文件，作为数组的一部分

+ close()：清空上述类中的变量——除了config.json中赋值的变量

+ __config()：读取config.json中的文件把内容获取 

+ __check()：用于检查设定分类的目录是否在"雷区"中

+ __is_log_exsit()：用于检查设定目录及其子目录下是否含有sort_log_out文件，有则为已经分类整理过的，原则上禁止再一次分类整理

+ __mk_log()：生成日志

+ __move(dir,i)：移动文件，dir是要移动的目录，i是文件编号

+ recover()：后悔药功能，前提是分类生成的sort_out_log文件不要删除和修改，而且是此路径下所有的分类都还原

+ Get_Info()：调用了__get()，把目录下所有的文件信息都拿到手，存储到info字典中，是一个超级大的数组，数组的长度就是total——文件的数量。同时也调用了__config、__check、__is_log_exist等检测函数，自身也被sort_out_by_*等函数调用。之所以设计成Public模式是为了有的人员仅仅是单纯的想看看文件信息而不是分类

+ sort_out_by_mtime(T_Type,Type)：根据修改时间把文件分类，T_Type是指的是最后访问时间（atime）、最后修改时间（mtime）、创建时间（ctime），参数如上对应。选择normal则是按照年月划分文件夹，选项all是按照年月日划分，推荐每天修改的文件太多了这么干，毕竟每个文件夹里文件高达上百也是可以了，按照月的划分怕太多你看不过来;easy模式是懒人专属，只有一个目录结构——年

+ sort_out_by_filetype()：根据文件类型分类，分出的类别不多，需要的话用户可以根据规则在配置文件中自己添加修改

+ sort_out_by_key(Key)：根据关键字分类，使用了正则表达，自由度高的代价就是容易出问题，请谨慎使用

## 配置文件config.json 
大体格式如下，看懂了记住关键字你可以自己写配置，直接叫我的默认配置滚蛋：

		{
			"File_Type":{
				"图片":["jpg","png"],
				"你想要的名字":["文件类型的名字——后缀"]
				},
			"Forbidden_Files":["ini","目录下含有这个后缀的文件就禁止分类"],
			"Forbidden_Dirs":["Windows","目录路径中含有这些关键词就别想分类了"]
			}

嗯，大致就是这样，上传的confg.json默认为中文，config_en.json为英文版模板——防止一些不方便用中文的系统出现bug,例如……没解决好中文现实的字符界面终端……（经验之谈）

## 准备添加的功能：

~~+ 图形界面~~

+ 添加更多的filetype和各种"雷区"

~~+ 利用Size区别大小文件，但是感觉作用不是太大啊～～

+ 注释和提示英文化，然后增加本地化支持
"# auto_sort_files" 
